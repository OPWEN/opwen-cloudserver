{
    "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "virtualMachines_opwenvm_name": {
            "defaultValue": "opwenvm",
            "type": "String"
        },
        "networkInterfaces_opwenvm763_name": {
            "defaultValue": "opwenvm763",
            "type": "String"
        },
        "publicIPAddresses_opwenvm_ip_name": {
            "defaultValue": "opwenvm-ip",
            "type": "String"
        },
        "virtualNetworks_opwenvm_vnet_name": {
            "defaultValue": "opwenvm-vnet",
            "type": "String"
        },
        "networkSecurityGroups_opwenvm_nsg_name": {
            "defaultValue": "opwenvm-nsg",
            "type": "String"
        }
    },
    "variables": {},
    // "resources": [
    //     {
    //         "type": "Microsoft.Network/networkSecurityGroups",
    //         "apiVersion": "2020-05-01",
    //         "name": "[parameters('networkSecurityGroups_opwenvm_nsg_name')]",
    //         "location": "eastus",
    //         "properties": {
    //             "securityRules": [
    //                 {
    //                     "name": "SSH",
    //                     "properties": {
    //                         "protocol": "TCP",
    //                         "sourcePortRange": "*",
    //                         "destinationPortRange": "22",
    //                         "sourceAddressPrefix": "*",
    //                         "destinationAddressPrefix": "*",
    //                         "access": "Allow",
    //                         "priority": 300,
    //                         "direction": "Inbound",
    //                         "sourcePortRanges": [],
    //                         "destinationPortRanges": [],
    //                         "sourceAddressPrefixes": [],
    //                         "destinationAddressPrefixes": []
    //                     }
    //                 },
    //                 {
    //                     "name": "HTTPS",
    //                     "properties": {
    //                         "protocol": "TCP",
    //                         "sourcePortRange": "*",
    //                         "destinationPortRange": "443",
    //                         "sourceAddressPrefix": "*",
    //                         "destinationAddressPrefix": "*",
    //                         "access": "Allow",
    //                         "priority": 320,
    //                         "direction": "Inbound",
    //                         "sourcePortRanges": [],
    //                         "destinationPortRanges": [],
    //                         "sourceAddressPrefixes": [],
    //                         "destinationAddressPrefixes": []
    //                     }
    //                 },
    //                 {
    //                     "name": "HTTP",
    //                     "properties": {
    //                         "protocol": "TCP",
    //                         "sourcePortRange": "*",
    //                         "destinationPortRange": "80",
    //                         "sourceAddressPrefix": "*",
    //                         "destinationAddressPrefix": "*",
    //                         "access": "Allow",
    //                         "priority": 340,
    //                         "direction": "Inbound",
    //                         "sourcePortRanges": [],
    //                         "destinationPortRanges": [],
    //                         "sourceAddressPrefixes": [],
    //                         "destinationAddressPrefixes": []
    //                     }
    //                 }
    //             ]
    //         }
    //     },
        // {
        //     "type": "Microsoft.Network/publicIPAddresses",
        //     "apiVersion": "2020-05-01",
        //     "name": "[parameters('publicIPAddresses_opwenvm_ip_name')]",
        //     "location": "eastus",
        //     "sku": {
        //         "name": "Basic"
        //     },
        //     "properties": {
        //         "ipAddress": "20.185.45.240",
        //         "publicIPAddressVersion": "IPv4",
        //         "publicIPAllocationMethod": "Dynamic",
        //         "idleTimeoutInMinutes": 4,
        //         "dnsSettings": {
        //             "domainNameLabel": "opwenvm",
        //             "fqdn": "opwenvm.eastus.cloudapp.azure.com"
        //         },
        //         "ipTags": []
        //     }
        // },
        // {
        //     "type": "Microsoft.Network/virtualNetworks",
        //     "apiVersion": "2020-05-01",
        //     "name": "[parameters('virtualNetworks_opwenvm_vnet_name')]",
        //     "location": "eastus",
        //     "properties": {
        //         "addressSpace": {
        //             "addressPrefixes": [
        //                 "10.0.0.0/24"
        //             ]
        //         },
        //         "subnets": [
        //             {
        //                 "name": "default",
        //                 "properties": {
        //                     "addressPrefix": "10.0.0.0/24",
        //                     "delegations": [],
        //                     "privateEndpointNetworkPolicies": "Enabled",
        //                     "privateLinkServiceNetworkPolicies": "Enabled"
        //                 }
        //             }
        //         ],
        //         "virtualNetworkPeerings": [],
        //         "enableDdosProtection": false,
        //         "enableVmProtection": false
        //     }
        // },
        {
            "type": "Microsoft.Compute/virtualMachines",
            "apiVersion": "2019-07-01",
            "name": "[parameters('virtualMachines_opwenvm_name')]",
            "location": "eastus",
            "dependsOn": [
                "[resourceId('Microsoft.Network/networkInterfaces', parameters('networkInterfaces_opwenvm763_name'))]"
            ],
            "properties": {
                // "hardwareProfile": {
                //     "vmSize": "Standard_D4s_v3"
                // },
                // "storageProfile": {
                //     "imageReference": {
                //         "publisher": "Canonical",
                //         "offer": "UbuntuServer",
                //         "sku": "18.04-LTS",
                //         "version": "latest"
                //     },
        //             "osDisk": {
        //                 "osType": "Linux",
        //                 "name": "[concat(parameters('virtualMachines_opwenvm_name'), '_OsDisk_1_ced0b0dbccc04536acb7743a366f2ed4')]",
        //                 "createOption": "FromImage",
        //                 "caching": "ReadWrite",
        //                 "managedDisk": {
        //                     "storageAccountType": "Premium_LRS",
        //                     "id": "[resourceId('Microsoft.Compute/disks', concat(parameters('virtualMachines_opwenvm_name'), '_OsDisk_1_ced0b0dbccc04536acb7743a366f2ed4'))]"
        //                 },
        //                 "diskSizeGB": 30
        //             },
        //             "dataDisks": []
        //         },
        //         "osProfile": {
        //             "computerName": "[parameters('virtualMachines_opwenvm_name')]",
        //             "adminUsername": "opwen",
        //             "linuxConfiguration": {
        //                 "disablePasswordAuthentication": false,
        //                 "provisionVMAgent": true
        //             },
        //             "secrets": [],
        //             "allowExtensionOperations": true,
        //             "requireGuestProvisionSignal": true
        //         },
        //         "networkProfile": {
        //             "networkInterfaces": [
        //                 {
        //                     "id": "[resourceId('Microsoft.Network/networkInterfaces', parameters('networkInterfaces_opwenvm763_name'))]"
        //                 }
        //             ]
        //         }
        //     }
        // },
        // {
        //     "type": "Microsoft.Network/networkSecurityGroups/securityRules",
        //     "apiVersion": "2020-05-01",
        //     "name": "[concat(parameters('networkSecurityGroups_opwenvm_nsg_name'), '/HTTP')]",
        //     "dependsOn": [
        //         "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_opwenvm_nsg_name'))]"
        //     ],
        //     "properties": {
        //         "protocol": "TCP",
        //         "sourcePortRange": "*",
        //         "destinationPortRange": "80",
        //         "sourceAddressPrefix": "*",
        //         "destinationAddressPrefix": "*",
        //         "access": "Allow",
        //         "priority": 340,
        //         "direction": "Inbound",
        //         "sourcePortRanges": [],
        //         "destinationPortRanges": [],
        //         "sourceAddressPrefixes": [],
        //         "destinationAddressPrefixes": []
        //     }
        // },
        // {
        //     "type": "Microsoft.Network/networkSecurityGroups/securityRules",
        //     "apiVersion": "2020-05-01",
        //     "name": "[concat(parameters('networkSecurityGroups_opwenvm_nsg_name'), '/HTTPS')]",
        //     "dependsOn": [
        //         "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_opwenvm_nsg_name'))]"
        //     ],
        //     "properties": {
        //         "protocol": "TCP",
        //         "sourcePortRange": "*",
        //         "destinationPortRange": "443",
        //         "sourceAddressPrefix": "*",
        //         "destinationAddressPrefix": "*",
        //         "access": "Allow",
        //         "priority": 320,
        //         "direction": "Inbound",
        //         "sourcePortRanges": [],
        //         "destinationPortRanges": [],
        //         "sourceAddressPrefixes": [],
        //         "destinationAddressPrefixes": []
        //     }
        // },
        // {
        //     "type": "Microsoft.Network/networkSecurityGroups/securityRules",
        //     "apiVersion": "2020-05-01",
        //     "name": "[concat(parameters('networkSecurityGroups_opwenvm_nsg_name'), '/SSH')]",
        //     "dependsOn": [
        //         "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_opwenvm_nsg_name'))]"
        //     ],
        //     "properties": {
        //         "protocol": "TCP",
        //         "sourcePortRange": "*",
        //         "destinationPortRange": "22",
        //         "sourceAddressPrefix": "*",
        //         "destinationAddressPrefix": "*",
        //         "access": "Allow",
        //         "priority": 300,
        //         "direction": "Inbound",
        //         "sourcePortRanges": [],
        //         "destinationPortRanges": [],
        //         "sourceAddressPrefixes": [],
        //         "destinationAddressPrefixes": []
        //     }
        // },
        // {
        //     "type": "Microsoft.Network/virtualNetworks/subnets",
        //     "apiVersion": "2020-05-01",
        //     "name": "[concat(parameters('virtualNetworks_opwenvm_vnet_name'), '/default')]",
        //     "dependsOn": [
        //         "[resourceId('Microsoft.Network/virtualNetworks', parameters('virtualNetworks_opwenvm_vnet_name'))]"
        //     ],
        //     "properties": {
        //         "addressPrefix": "10.0.0.0/24",
        //         "delegations": [],
        //         "privateEndpointNetworkPolicies": "Enabled",
        //         "privateLinkServiceNetworkPolicies": "Enabled"
        //     }
        // },
        {
            "type": "Microsoft.Network/networkInterfaces",
            "apiVersion": "2020-05-01",
            "name": "[parameters('networkInterfaces_opwenvm763_name')]",
            "location": "eastus",
            "dependsOn": [
                "[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddresses_opwenvm_ip_name'))]",
                "[resourceId('Microsoft.Network/virtualNetworks/subnets', parameters('virtualNetworks_opwenvm_vnet_name'), 'default')]",
                "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_opwenvm_nsg_name'))]"
            ],
            // "properties": {
            //     "ipConfigurations": [
            //         {
            //             "name": "ipconfig1",
            //             "properties": {
            //                 "privateIPAddress": "10.0.0.4",
            //                 "privateIPAllocationMethod": "Dynamic",
            //                 "publicIPAddress": {
            //                     "id": "[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddresses_opwenvm_ip_name'))]"
            //                 },
            //                 "subnet": {
            //                     "id": "[resourceId('Microsoft.Network/virtualNetworks/subnets', parameters('virtualNetworks_opwenvm_vnet_name'), 'default')]"
            //                 },
            //                 "primary": true,
            //                 "privateIPAddressVersion": "IPv4"
            //             }
            //         }
            //     ],
                "dnsSettings": {
                    "dnsServers": []
                },
                "enableAcceleratedNetworking": true,
                "enableIPForwarding": false,
                "networkSecurityGroup": {
                    "id": "[resourceId('Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroups_opwenvm_nsg_name'))]"
                }
            }
        }
    ]
}